# 季節・期間限定の背景切り替え機能仕様（WelcomeScreen）

## 1. 概要

`WelcomeScreen`（チャット待機画面）において、現在の季節や特定のイベント期間（春の桜、夏、クリスマス、ハロウィンなど）に合わせて、背景のSVGアニメーションやデザインを動的に切り替える機能の仕様です。
ユーザーエージェントに季節感を感じさせ、親しみやすく飽きのこないUXを提供することを目的としています。

## 2. 基本仕様（通常背景とフォールバックについて）

**本機能は、年間を通じて「常に何らかの特別・イベント背景」を表示するものではありません。**

- **通常期間の動作**: 特定のイベント期間として定義されていない日付（何もない日常の期間）にアプリを開いた場合は、これまで通りの**標準的でシンプルな通常背景（デフォルト背景）**が表示されます。
- **フォールバック**: 設定された期間内であっても、対象となるSVGファイルが存在しない、または何らかの理由で読み込みに失敗した場合は、自動的に通常背景へフォールバックします。

これにより、イベント時以外の日常利用において、派手な演出が業務や作業の妨げになることを防ぎ、快適な操作性を維持します。

## 3. 実装の枠組み（想定）

### 3.1. 期間と背景アセットの定義

イベントの開始日・終了日と、表示するCSSクラスやSVGのパスをマッピングする設定データ（例: `src/config/seasonalBackgrounds.ts`）を用意します。

```typescript
export const seasonalBackgrounds = [
  {
    id: 'spring-sakura',
    start: '03-15', // 3月15日開始
    end: '04-10',   // 4月10日終了
    cssClass: 'bg-spring', // WelcomeScreen.cssに定義するクラス名
  },
  {
    id: 'winter-snow',
    start: '12-20',
    end: '12-25',
    cssClass: 'bg-christmas',
  }
];
```

### 3.2. コンポーネントでの判定ロジック

`WelcomeScreen.jsx` または専用のカスタムフック（例: `useSeasonalBackground`）にて、現在の日付（月・日）が上記の設定期間内に含まれているかを判定します。
該当するイベントがある場合は対応するCSSクラス（今回であれば `.welcome-container--zen.bg-spring` など）を付与し、該当しない場合は通常通りのクラスのみとします。

### 3.3. CSSでの切り替え

`WelcomeScreen.css` にて、各季節ごとの背景画像（SVG）を設定します。

```css
/* デフォルトの通常背景 */
.welcome-container--zen {
  background-color: var(--color-bg-base);
  /* その他通常時のスタイル */
}

/* 春（桜）の特別背景 (ライトモード) */
.welcome-container--zen.bg-spring {
  background-image: url('/svg/spring-background.svg');
  background-size: cover;
  background-position: center bottom;
  background-repeat: no-repeat;
  background-attachment: fixed;
  transition: background-image 0.4s ease-in-out;
}

/* 春（桜）の特別背景 (ダークモード) */
[data-theme='dark'] .welcome-container--zen.bg-spring {
  background-image: url('/svg/spring-background-dark.svg');
}
```

### 3.4. ダークモードへの対応

`WelcomeScreen` のUIと文字の視認性を確保するため、**ダークモード用の別SVGファイル（`[イベント名]-dark.svg`）を作成し、CSSの `[data-theme='dark']` 属性で出し分ける**ことを基本コンセプトとします。
これにより、明るいテーマ（さわやかな青空など）と暗いテーマ（夜空など）をシームレスに切り替えることが可能です。

## 4. イベント背景SVG作成時のマニュアル（Tips）

新しく背景用のアニメーション付きSVGファイルを作成する際は、以下の点に注意してデザインを行ってください。

### 4.1. ファイル構成と拡張性

1. `public/svg/` ディレクトリに、ライトモード用（例: `autumn-leaves.svg`）とダークモード用（例: `autumn-leaves-dark.svg`）の2種類をセットで作成します。
2. SVG要素の `viewBox` は `0 0 1920 1080` を基準とし、`preserveAspectRatio="xMidYMid slice"` を指定してフル画面のレスポンシブ拡大縮小に対応させます。

### 4.2. UI要素との被りを避ける（クリティカルゾーンの回避）

`WelcomeScreen` は画面中央に重要なUI（タイトル、チャット入力欄、フッターリンクなど）が配置されるため、**中央の幅 約800px（X座標: 560px 〜 1360px 付近）の領域は「クリティカルゾーン」として、目立つオブジェクトの配置を避けてください**。

- **推奨配置（セーフゾーン）**:
  - 画面の左下、あるいは左側の余白（X: 0 〜 500 付近）
  - 画面の右下、あるいは右側の余白（X: 1400 〜 1920 付近）
- **アニメーション要素**:
    桜吹雪や雪のような画面全体を舞うアニメーションは中央を通っても構いませんが、要素のサイズを小さく保ち、不透明度を下げる（例: `opacity: 0.8` など）ことで、文字テキストの入力や視認性を阻害しないように配慮してください。

### 4.3. 不自然な形状（宙に浮くなど）を防ぐためのヒント

ベクターデータ（`<path>` など）で木や建物などを描画する際、ブラウザの表示比率が変わっても不自然に見えないように以下の工夫を推奨します。

- **アンカーポイントの論理的接続**: 枝を描く場合、独立したパスではなく、必ずメインの幹（Trunk）のパスの途中の座標から枝派生（`M` コマンドで接続）するように `d` 属性の数値を設計してください。
- **画面端の処理**: 地面や山の根本などは、画面の外側（Y座標: 1080以上、X座標: マイナスや1920以上）へはみ出すくらい余裕を持たせて描画することで、ウィンドウをリサイズした際に「オブジェクトが途切れて宙に浮いている」ように見えるのを防ぐことができます。
- **初期状態の非表示**: `@keyframes` で `animation-delay` を用いてアニメーション要素（花びらなど）を時間差で作動させる場合、アニメーション開始前（0秒〜delay秒の間）に要素が「左上」などの原点に固まってスタック表示されてしまうことがあります。必ずラッパー要素に `opacity: 0;` を初期設定として当ててください。

## 5. テストとデバッグ

開発時に一時的に任意の季節背景を確認できるよう、`src/config/seasonalBackgrounds.ts` の当該イベント期間（`start`/`end`）を今日の日付に変更し、ライトモード・ダークモードの両方で問題なく切り替わり、UIの視認性が確保されているかテストしてください。
